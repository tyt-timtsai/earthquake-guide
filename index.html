<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earthquake Safety Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 414px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            padding-bottom: 120px;
        }

        .header {
            background: linear-gradient(135deg, #FF416C, #FF4B2B);
            padding: 60px 20px 20px 20px;
            text-align: center;
            color: white;
            position: relative;
        }

        .header h1 {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 5px;
            padding: 0 80px;
        }

        .header .subtitle {
            font-size: 14px;
            opacity: 0.9;
        }

        .language-selector {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.9);
            border: 2px solid rgba(255,255,255,0.5);
            color: #333;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            min-width: 120px;
            text-align: center;
        }
        
        .language-selector:hover {
            background: rgba(255,255,255,1);
            transform: scale(1.05);
        }

        .back-button {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(255,255,255,0.9);
            border: 2px solid rgba(255,255,255,0.5);
            color: #333;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .back-button:hover {
            background: rgba(255,255,255,1);
            transform: scale(1.05);
        }

        .emergency-button {
            background: linear-gradient(135deg, #FF6B35, #FF8E53);
            color: white;
            border: none;
            margin: 30px 20px;
            padding: 40px 20px;
            border-radius: 15px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            width: calc(100% - 40px);
            box-shadow: 0 6px 20px rgba(255,107,53,0.3);
            position: relative;
            transition: transform 0.2s ease;
        }

        .emergency-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255,107,53,0.4);
        }

        .emergency-button:active {
            transform: translateY(0px);
        }

        .location-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            padding: 20px;
        }

        .location-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid #f0f0f0;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .location-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: #667eea;
        }

        .location-icon {
            font-size: 48px;
            margin-bottom: 15px;
            display: block;
        }

        .location-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .location-desc {
            font-size: 14px;
            color: #666;
        }

        .action-guide {
            padding: 20px;
        }

        .action-visual {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            color: white;
            margin-bottom: 25px;
            position: relative;
            overflow: hidden;
        }

        .action-visual::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: rotate 4s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .action-icon {
            font-size: 72px;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }

        .action-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .action-steps {
            list-style: none;
            margin: 25px 0;
        }

        .action-steps li {
            background: white;
            margin: 10px 0;
            padding: 20px;
            border-radius: 12px;
            border-left: 5px solid;
            font-size: 18px;
            font-weight: 600;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .step-drop { border-left-color: #FF4B2B; }
        .step-cover { border-left-color: #FF8C00; }
        .step-hold { border-left-color: #00AA00; }

        .situation-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 25px;
        }

        .situation-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 2px solid #f0f0f0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .situation-card:hover {
            transform: translateY(-2px);
            border-color: #667eea;
            box-shadow: 0 4px 15px rgba(102,126,234,0.2);
        }

        .situation-icon {
            font-size: 32px;
            margin-bottom: 8px;
            display: block;
        }

        .situation-title {
            font-size: 14px;
            font-weight: 600;
        }

        .specific-guide {
            padding: 20px;
        }

        .guide-visual {
            background: linear-gradient(135deg, #11998e, #38ef7d);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            color: white;
            margin-bottom: 25px;
        }

        .guide-illustration {
            font-size: 80px;
            margin-bottom: 15px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .instructions {
            list-style: none;
        }

        .instructions li {
            margin: 15px 0;
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
            display: flex;
            align-items: center;
        }

        .do { background: linear-gradient(90deg, rgba(0,170,0,0.1), rgba(0,170,0,0.05)); }
        .dont { background: linear-gradient(90deg, rgba(255,0,0,0.1), rgba(255,0,0,0.05)); }
        .warning { background: linear-gradient(90deg, rgba(255,140,0,0.1), rgba(255,140,0,0.05)); }

        .instruction-icon {
            font-size: 24px;
            margin-right: 15px;
        }

        .audio-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            margin: 20px auto;
            display: block;
            box-shadow: 0 4px 15px rgba(102,126,234,0.3);
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .footer-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            width: 100%;
            max-width: 414px;
            padding: 15px 20px;
            border-top: 1px solid #eee;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
        }

        .nav-item {
            text-align: center;
            padding: 10px;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .nav-item:hover {
            background: #f5f5f5;
        }

        .nav-item.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .nav-icon {
            font-size: 24px;
            margin-bottom: 5px;
            display: block;
        }

        .nav-text {
            font-size: 12px;
            font-weight: 600;
        }

        @media (max-width: 480px) {
            .container {
                max-width: 100%;
            }
            
            .emergency-button {
                font-size: 24px;
                padding: 35px 20px;
            }
            
            .location-icon {
                font-size: 40px;
            }
            
            .action-icon {
                font-size: 60px;
            }
        }

        .hidden {
            display: none !important;
        }
        
        .safety-image {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            margin: 15px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .visual-guide {
            text-align: center;
            margin: 20px 0;
        }
        
        .dch-steps {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .dch-step {
            flex: 1;
            min-width: 100px;
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .step-number {
            font-size: 24px;
            font-weight: bold;
            color: #FF6B35;
            margin-bottom: 5px;
        }
        
        .step-text {
            font-size: 14px;
            font-weight: 600;
        }

        .emergency-card {
            background: linear-gradient(90deg, rgba(255,0,0,0.05), rgba(255,0,0,0.1));
            border-color: #FF0000;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <button class="back-button" onclick="goBack()">â† <span data-text="back">Back</span></button>
            <select class="language-selector" onchange="changeLanguage(this.value)">
                <option value="zh">ç¹é«”ä¸­æ–‡</option>
                <option value="en">English</option>
                <option value="ja">æ—¥æœ¬èª</option>
            </select>
            <h1 data-text="app-title">Earthquake Safety Guide</h1>
            <div class="subtitle" data-text="app-subtitle">Stay Safe During Earthquakes</div>
        </div>

        <!-- Home Screen -->
        <div id="home-screen" class="screen active">
            <button class="emergency-button" onclick="showEmergencyMode()">
                âš¡ <span data-text="emergency-button">EARTHQUAKE HAPPENING NOW?</span>
            </button>
            
            <div class="location-grid">
                <div class="location-card" onclick="showLocationGuide('indoor')">
                    <span class="location-icon">ğŸ </span>
                    <div class="location-title" data-text="indoor-title">Indoor Spaces</div>
                    <div class="location-desc" data-text="indoor-desc">Home, office, public buildings</div>
                </div>
                
                <div class="location-card" onclick="showLocationGuide('outdoor')">
                    <span class="location-icon">ğŸŒ³</span>
                    <div class="location-title" data-text="outdoor-title">Outdoor Areas</div>
                    <div class="location-desc" data-text="outdoor-desc">Streets, parks, vehicles</div>
                </div>
                
                <div class="location-card" onclick="showAbout()">
                    <span class="location-icon">â„¹ï¸</span>
                    <div class="location-title" data-text="about-title">Safety Tips</div>
                    <div class="location-desc" data-text="about-desc">Learn basic principles</div>
                </div>
            </div>
        </div>

        <!-- Emergency Mode Screen -->
        <div id="emergency-screen" class="screen">
            <div style="padding: 20px; text-align: center;">
                <h2 style="color: #FF0000; font-size: 24px; margin-bottom: 30px;" data-text="emergency-title">ğŸš¨ EARTHQUAKE HAPPENING</h2>
                <p style="font-size: 18px; margin-bottom: 30px;" data-text="emergency-question">Where are you RIGHT NOW?</p>
                
                <div class="location-grid">
                    <div class="location-card" onclick="showEmergencyGuide('indoor')" style="border-color: #FF0000; background: linear-gradient(90deg, rgba(255,0,0,0.05), rgba(255,0,0,0.1));">
                        <span class="location-icon">ğŸ </span>
                        <div class="location-title" data-text="emergency-indoor">INSIDE BUILDING</div>
                    </div>
                    
                    <div class="location-card" onclick="showEmergencyGuide('outdoor')" style="border-color: #FF0000; background: linear-gradient(90deg, rgba(255,0,0,0.05), rgba(255,0,0,0.1));">
                        <span class="location-icon">ğŸŒ³</span>
                        <div class="location-title" data-text="emergency-outdoor">OUTSIDE</div>
                    </div>
                    
                    <div class="location-card" onclick="showEmergencyGuide('vehicle')" style="border-color: #FF0000; background: linear-gradient(90deg, rgba(255,0,0,0.05), rgba(255,0,0,0.1));">
                        <span class="location-icon">ğŸš—</span>
                        <div class="location-title" data-text="emergency-vehicle">IN VEHICLE</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Location Guide Screen -->
        <div id="location-screen" class="screen">
            <div class="action-guide">
                <div class="visual-guide">
                    <img src="" id="main-safety-image" class="safety-image" alt="Drop Cover Hold" style="display: none;">
                    <div class="action-visual">
                        <span class="action-icon" id="location-icon">ğŸ </span>
                        <div class="action-title" id="location-title" data-text="drop-cover-hold">Drop, Cover, Hold On</div>
                    </div>
                </div>
                
                <ul class="action-steps">
                    <li class="step-drop">ğŸ”´ <span data-text="step-drop">1. DROP to ground immediately</span></li>
                    <li class="step-cover">ğŸŸ¡ <span data-text="step-cover">2. Take COVER under sturdy furniture</span></li>
                    <li class="step-hold">ğŸŸ¢ <span data-text="step-hold">3. HOLD ON and protect your head</span></li>
                </ul>
                
                <p id="situation-question" style="text-align: center; margin: 20px 0; font-weight: 600;" data-text="specific-situation">What's your specific situation?</p>
                
                <div class="situation-grid" id="situation-grid">
                    <!-- Situations will be populated by JavaScript -->
                </div>
                
                <button class="audio-button">
                    ğŸ”Š <span data-text="voice-guide">Voice Instructions</span>
                </button>
            </div>
        </div>

        <!-- Specific Situation Screen -->
        <div id="situation-screen" class="screen">
            <div class="specific-guide">
                <div class="visual-guide">
                    <img src="" id="situation-image" class="safety-image" alt="Situation Guide" style="display: none;">
                    <div class="guide-visual">
                        <div class="guide-illustration" id="situation-illustration">ğŸ›ï¸</div>
                        <h3 id="situation-title" data-text="in-bed">In Bed</h3>
                    </div>
                </div>
                
                <ul class="instructions" id="situation-instructions">
                    <!-- Instructions will be populated by JavaScript -->
                </ul>
                
                <button class="audio-button">
                    ğŸ”Š <span data-text="play-instructions">Play Instructions</span>
                </button>
            </div>
        </div>

        <!-- About Screen -->
        <div id="about-screen" class="screen">
            <div class="specific-guide">
                <div class="guide-visual">
                    <div class="guide-illustration">ğŸ›¡ï¸</div>
                    <h3 data-text="safety-principles">Safety Principles</h3>
                </div>
                
                <ul class="instructions">
                    <li class="instructions do">
                        <span class="instruction-icon">ğŸ”´</span>
                        <span data-text="principle-drop">DROP to the ground immediately</span>
                    </li>
                    <li class="instructions do">
                        <span class="instruction-icon">ğŸŸ¡</span>
                        <span data-text="principle-cover">Take COVER under sturdy furniture</span>
                    </li>
                    <li class="instructions do">
                        <span class="instruction-icon">ğŸŸ¢</span>
                        <span data-text="principle-hold">HOLD ON and protect your head</span>
                    </li>
                    <li class="instructions warning">
                        <span class="instruction-icon">âš ï¸</span>
                        <span data-text="principle-wait">Wait until shaking completely stops</span>
                    </li>
                    <li class="instructions dont">
                        <span class="instruction-icon">âŒ</span>
                        <span data-text="principle-dont-run">DON'T run outside during shaking</span>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Footer Navigation -->
        <div class="footer-nav">
            <div class="nav-item active" onclick="showScreen('home')">
                <span class="nav-icon">ğŸ </span>
                <div class="nav-text" data-text="nav-home">Home</div>
            </div>
            <div class="nav-item" onclick="showEmergencyMode()">
                <span class="nav-icon">ğŸš¨</span>
                <div class="nav-text" data-text="nav-emergency">Emergency</div>
            </div>
            <div class="nav-item" onclick="showAbout()">
                <span class="nav-icon">â„¹ï¸</span>
                <div class="nav-text" data-text="nav-about">About</div>
            </div>
        </div>
    </div>

    <script>

        // Language translations
        const translations = {
            en: {
                "app-title": "Earthquake Safety Guide",
                "app-subtitle": "Stay Safe During Earthquakes",
                "emergency-button": "Click for Quick Safety Guide",
                "indoor-title": "Indoor Spaces",
                "indoor-desc": "Home, office, public buildings",
                "outdoor-title": "Outdoor Areas", 
                "outdoor-desc": "Streets, parks, vehicles",
                "about-title": "Safety Tips",
                "about-desc": "Learn basic principles",
                "emergency-title": "ğŸš¨ EARTHQUAKE HAPPENING",
                "emergency-question": "Where are you RIGHT NOW?",
                "emergency-indoor": "INSIDE BUILDING",
                "emergency-outdoor": "OUTSIDE",
                "emergency-vehicle": "IN VEHICLE",
                "drop-cover-hold": "Drop, Cover, Hold On",
                "step-drop": "1. DROP to ground immediately",
                "step-cover": "2. Take COVER under sturdy furniture", 
                "step-hold": "3. HOLD ON and protect your head",
                "specific-situation": "What's your specific situation?",
                "voice-guide": "Voice Instructions",
                "play-instructions": "Play Instructions",
                "nav-home": "Home",
                "nav-emergency": "Emergency",
                "nav-about": "Tips",
                "back": "Back",
                "in-bed": "In Bed",
                "in-kitchen": "In Kitchen",
                "in-bathroom": "In Bathroom", 
                "in-office": "In Office",
                "in-theater": "In Theater",
                "in-elevator": "Near Elevator",
                "on-street": "On Street",
                "in-car": "In Car",
                "at-station": "At Station",
                "safety-principles": "Safety Principles",
                "principle-drop": "DROP to the ground immediately",
                "principle-cover": "Take COVER under sturdy furniture",
                "principle-hold": "HOLD ON and protect your head",
                "principle-wait": "Wait until shaking completely stops",
                "principle-dont-run": "DON'T run outside during shaking"
            },
            zh: {
                "app-title": "åœ°éœ‡å®‰å…¨æŒ‡å—",
                "app-subtitle": "åœ°éœ‡æ™‚ä¿æŒå®‰å…¨",
                "emergency-button": "é»æ“Šç²å–å¿«é€Ÿå®‰å…¨æŒ‡å—",
                "indoor-title": "å®¤å…§ç©ºé–“",
                "indoor-desc": "å®¶ä¸­ã€è¾¦å…¬å®¤ã€å…¬å…±å»ºç¯‰",
                "outdoor-title": "æˆ¶å¤–å€åŸŸ",
                "outdoor-desc": "è¡—é“ã€å…¬åœ’ã€è»Šè¼›",
                "about-title": "å®‰å…¨é ˆçŸ¥",
                "about-desc": "å­¸ç¿’åŸºæœ¬åŸå‰‡",
                "emergency-title": "ğŸš¨ åœ°éœ‡æ­£åœ¨ç™¼ç”Ÿ",
                "emergency-question": "æ‚¨ç¾åœ¨åœ¨å“ªè£¡ï¼Ÿ",
                "emergency-indoor": "å»ºç¯‰ç‰©å…§",
                "emergency-outdoor": "æˆ¶å¤–",
                "emergency-vehicle": "è»Šè¼›å…§",
                "drop-cover-hold": "è¶´ä¸‹ã€æ©è­·ã€ç©©ä½",
                "step-drop": "1. ç«‹å³è¶´ä¸‹",
                "step-cover": "2. æ‰¾æ©è­·èº²åœ¨å …å›ºå®¶å…·ä¸‹",
                "step-hold": "3. æŠ“ç©©ä¸¦ä¿è­·é ­éƒ¨",
                "specific-situation": "æ‚¨çš„å…·é«”æƒ…æ³æ˜¯ï¼Ÿ",
                "voice-guide": "èªéŸ³æŒ‡å°",
                "play-instructions": "æ’­æ”¾æŒ‡ç¤º",
                "nav-home": "é¦–é ",
                "nav-emergency": "ç·Šæ€¥",
                "nav-about": "é ˆçŸ¥",
                "back": "è¿”å›",
                "in-bed": "åœ¨åºŠä¸Š",
                "in-kitchen": "åœ¨å»šæˆ¿",
                "in-bathroom": "åœ¨æµ´å®¤",
                "in-office": "åœ¨è¾¦å…¬å®¤", 
                "in-theater": "åœ¨é›»å½±é™¢",
                "in-elevator": "é›»æ¢¯é™„è¿‘",
                "on-street": "åœ¨è¡—ä¸Š",
                "in-car": "åœ¨è»Šå…§",
                "at-station": "åœ¨è»Šç«™",
                "safety-principles": "å®‰å…¨åŸå‰‡",
                "principle-drop": "ç«‹å³è¶´ä¸‹",
                "principle-cover": "æ‰¾æ©è­·èº²åœ¨å …å›ºå®¶å…·ä¸‹",
                "principle-hold": "æŠ“ç©©ä¸¦ä¿è­·é ­éƒ¨",
                "principle-wait": "ç­‰åˆ°éœ‡å‹•å®Œå…¨åœæ­¢",
                "principle-dont-run": "éœ‡å‹•æ™‚ä¸è¦è·‘åˆ°å¤–é¢"
            },
            ja: {
                "app-title": "åœ°éœ‡å®‰å…¨ã‚¬ã‚¤ãƒ‰",
                "app-subtitle": "åœ°éœ‡æ™‚ã®å®‰å…¨ç¢ºä¿",
                "emergency-button": "ã‚¯ã‚¤ãƒƒã‚¯å®‰å…¨ã‚¬ã‚¤ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯",
                "indoor-title": "å±‹å†…ã‚¹ãƒšãƒ¼ã‚¹",
                "indoor-desc": "è‡ªå®…ã€ã‚ªãƒ•ã‚£ã‚¹ã€å…¬å…±å»ºç‰©",
                "outdoor-title": "å±‹å¤–ã‚¨ãƒªã‚¢",
                "outdoor-desc": "è¡—è·¯ã€å…¬åœ’ã€è»Šä¸¡",
                "about-title": "å®‰å…¨ã®ã‚³ãƒ„",
                "about-desc": "åŸºæœ¬åŸå‰‡ã‚’å­¦ã¶",
                "emergency-title": "ğŸš¨ åœ°éœ‡ç™ºç”Ÿä¸­",
                "emergency-question": "ç¾åœ¨ã©ã“ã«ã„ã¾ã™ã‹ï¼Ÿ",
                "emergency-indoor": "å»ºç‰©å†…",
                "emergency-outdoor": "å±‹å¤–",
                "emergency-vehicle": "è»Šä¸¡å†…",
                "drop-cover-hold": "èº«ã‚’ä¼ã›ã€éš ã‚Œã€ã—ãŒã¿ã¤ã",
                "step-drop": "1. ã™ãã«èº«ã‚’ä¼ã›ã‚‹",
                "step-cover": "2. é ‘ä¸ˆãªå®¶å…·ã®ä¸‹ã«éš ã‚Œã‚‹",
                "step-hold": "3. ã—ã£ã‹ã‚Šã¤ã‹ã‚“ã§é ­ã‚’å®ˆã‚‹",
                "specific-situation": "å…·ä½“çš„ãªçŠ¶æ³ã¯ï¼Ÿ",
                "voice-guide": "éŸ³å£°ã‚¬ã‚¤ãƒ‰",
                "play-instructions": "æŒ‡ç¤ºã‚’å†ç”Ÿ",
                "nav-home": "ãƒ›ãƒ¼ãƒ ",
                "nav-emergency": "ç·Šæ€¥",
                "nav-about": "ã‚³ãƒ„",
                "back": "æˆ»ã‚‹",
                "in-bed": "ãƒ™ãƒƒãƒ‰ã§",
                "in-kitchen": "ã‚­ãƒƒãƒãƒ³ã§",
                "in-bathroom": "æµ´å®¤ã§",
                "in-office": "ã‚ªãƒ•ã‚£ã‚¹ã§",
                "in-theater": "æ˜ ç”»é¤¨ã§", 
                "in-elevator": "ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ä»˜è¿‘",
                "on-street": "è·¯ä¸Šã§",
                "in-car": "è»Šå†…ã§",
                "at-station": "é§…ã§",
                "safety-principles": "å®‰å…¨ã®åŸå‰‡",
                "principle-drop": "ã™ãã«èº«ã‚’ä¼ã›ã‚‹",
                "principle-cover": "é ‘ä¸ˆãªå®¶å…·ã®ä¸‹ã«éš ã‚Œã‚‹",
                "principle-hold": "ã—ã£ã‹ã‚Šã¤ã‹ã‚“ã§é ­ã‚’å®ˆã‚‹",
                "principle-wait": "æºã‚ŒãŒå®Œå…¨ã«æ­¢ã¾ã‚‹ã¾ã§å¾…ã¤",
                "principle-dont-run": "æºã‚Œä¸­ã«å¤–ã«èµ°ã‚‰ãªã„"
            }
        };

        // Situation data
        const situations = {
            indoor: [
                { id: 'bed', icon: 'ğŸ›ï¸', key: 'in-bed' },
                { id: 'kitchen', icon: 'ğŸ³', key: 'in-kitchen' },
                { id: 'bathroom', icon: 'ğŸš¿', key: 'in-bathroom' },
                { id: 'office', icon: 'ğŸ’¼', key: 'in-office' },
                { id: 'theater', icon: 'ğŸ¬', key: 'in-theater' },
                { id: 'elevator', icon: 'ğŸ¢', key: 'in-elevator' }
            ],
            outdoor: [
                { id: 'street', icon: 'ğŸš¶', key: 'on-street' },
                { id: 'car', icon: 'ğŸš—', key: 'in-car' },
                { id: 'station', icon: 'ğŸš‰', key: 'at-station' }
            ]
        };

        // Current state
        let currentLanguage = 'zh';
        let currentLocation = '';
        let navigationStack = [];

        // Initialize app
        function init() {
            console.log('Initializing app...');
            updateLanguage();
            console.log('App initialized successfully');
        }

        // Language functions
        function changeLanguage(lang) {
            console.log('Changing language to:', lang);
            currentLanguage = lang;
            updateLanguage();
        }

        function updateLanguage() {
            const elements = document.querySelectorAll('[data-text]');
            elements.forEach(element => {
                const key = element.getAttribute('data-text');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
        }

        // Navigation functions
        function showScreen(screenId) {
            // Hide all screens
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Show target screen
            document.getElementById(screenId + '-screen').classList.add('active');
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Update back button
            const backBtn = document.querySelector('.back-button');
            if (screenId === 'home') {
                backBtn.style.display = 'none';
                navigationStack = [];
            } else {
                backBtn.style.display = 'block';
            }
        }

        function goBack() {
            if (navigationStack.length > 0) {
                const previousScreen = navigationStack.pop();
                showScreen(previousScreen);
            } else {
                showScreen('home');
            }
        }

        // Emergency functions
        function showEmergencyMode() {
            console.log('Showing emergency mode');
            navigationStack.push('home');
            showScreen('emergency');
            
            // Add vibration if supported
            if (navigator.vibrate) {
                navigator.vibrate([200, 100, 200]);
            }
        }

        function showEmergencyGuide(location) {
            navigationStack.push('emergency');
            showLocationGuide(location, true);
        }

        // Location guide functions
        function showLocationGuide(location, isEmergency = false) {
            console.log('Showing location guide for:', location, 'Emergency:', isEmergency);
            if (!isEmergency) {
                navigationStack.push('home');
            }
            
            currentLocation = location;
            showScreen('location');
            
            // Update location display
            const locationIcon = document.getElementById('location-icon');
            const locationTitle = document.getElementById('location-title');
            const mainImage = document.getElementById('main-safety-image');
            
            // Hide the image since safetyImages was removed
            mainImage.style.display = 'none';
            
            if (location === 'indoor') {
                locationIcon.textContent = 'ğŸ ';
                locationTitle.setAttribute('data-text', 'drop-cover-hold');
            } else if (location === 'outdoor') {
                locationIcon.textContent = 'ğŸŒ³';
                locationTitle.setAttribute('data-text', 'drop-cover-hold');
            } else if (location === 'vehicle') {
                locationIcon.textContent = 'ğŸš—';
                locationTitle.setAttribute('data-text', 'drop-cover-hold');
            }
            
            // Populate situations
            populateSituations(location);
            updateLanguage();
        }

        function populateSituations(location) {
            const situationGrid = document.getElementById('situation-grid');
            const situationQuestion = document.getElementById('situation-question');
            situationGrid.innerHTML = '';
            
            const locationSituations = situations[location] || [];
            
            // Hide the question text if no situations available
            if (locationSituations.length === 0) {
                situationQuestion.style.display = 'none';
            } else {
                situationQuestion.style.display = 'block';
            }
            
            locationSituations.forEach(situation => {
                const card = document.createElement('div');
                card.className = 'situation-card';
                card.onclick = () => showSituationGuide(situation.id);
                
                card.innerHTML = `
                    <span class="situation-icon">${situation.icon}</span>
                    <div class="situation-title" data-text="${situation.key}">${translations[currentLanguage][situation.key] || situation.key}</div>
                `;
                
                situationGrid.appendChild(card);
            });
        }

        // Situation guide functions
        function showSituationGuide(situationId) {
            navigationStack.push('location');
            showScreen('situation');
            
            const illustration = document.getElementById('situation-illustration');
            const title = document.getElementById('situation-title');
            const instructions = document.getElementById('situation-instructions');
            const situationImage = document.getElementById('situation-image');
            
            // Clear previous instructions
            instructions.innerHTML = '';
            
            // Set illustration and title based on situation
            const situationData = getSituationData(situationId);
            illustration.textContent = situationData.icon;
            title.setAttribute('data-text', situationData.titleKey);
            title.textContent = translations[currentLanguage][situationData.titleKey] || situationData.titleKey;
            
            // Show appropriate image based on situation
            const imageMap = {
                'bed': 'inBed',
                'kitchen': 'kitchen',
                'bathroom': 'inBathroom',
                'office': 'atOffice',
                'theater': 'atTheater',
                'elevator': 'doNotElevator'
            };
            
            // Hide the image since safetyImages was removed
            situationImage.style.display = 'none';
            
            // Add instructions
            situationData.instructions.forEach(instruction => {
                const li = document.createElement('li');
                li.className = `instructions ${instruction.type}`;
                li.innerHTML = `
                    <span class="instruction-icon">${instruction.icon}</span>
                    <span data-text="${instruction.key}">${translations[currentLanguage][instruction.key] || instruction.text}</span>
                `;
                instructions.appendChild(li);
            });
            
            updateLanguage();
        }

        function getSituationData(situationId) {
            const situationData = {
                bed: {
                    icon: 'ğŸ›ï¸',
                    titleKey: 'in-bed',
                    instructions: [
                        { type: 'do', icon: 'âœ…', key: 'bed-stay', text: 'STAY in bed' },
                        { type: 'do', icon: 'âœ…', key: 'bed-pillow', text: 'Use pillow to protect head' },
                        { type: 'do', icon: 'âœ…', key: 'bed-prone', text: 'Turn face down (prone position)' },
                        { type: 'dont', icon: 'âŒ', key: 'bed-dont-get-up', text: "DON'T get up and run" },
                        { type: 'warning', icon: 'âš ï¸', key: 'bed-wait', text: 'Wait until shaking completely stops' }
                    ]
                },
                kitchen: {
                    icon: 'ğŸ³',
                    titleKey: 'in-kitchen',
                    instructions: [
                        { type: 'do', icon: 'ğŸ”¥', key: 'kitchen-fire-close', text: 'Turn off fire if next to stove' },
                        { type: 'do', icon: 'âœ…', key: 'kitchen-cover', text: 'Take cover under table' },
                        { type: 'dont', icon: 'âŒ', key: 'kitchen-dont-reach', text: "DON'T risk injury to reach stove" },
                        { type: 'warning', icon: 'âš ï¸', key: 'kitchen-hot', text: 'Watch for hot pots and spilling liquids' },
                        { type: 'warning', icon: 'âš ï¸', key: 'kitchen-glass', text: 'Beware of falling dishes and glassware' }
                    ]
                },
                bathroom: {
                    icon: 'ğŸš¿',
                    titleKey: 'in-bathroom',
                    instructions: [
                        { type: 'dont', icon: 'âŒ', key: 'bathroom-dont-rush', text: "DON'T rush out of bathroom" },
                        { type: 'do', icon: 'âœ…', key: 'bathroom-crouch', text: 'Crouch low and protect head' },
                        { type: 'do', icon: 'âœ…', key: 'bathroom-basin', text: 'Use basin or hands to shield head' },
                        { type: 'warning', icon: 'âš ï¸', key: 'bathroom-mirror', text: 'Watch for falling mirrors' },
                        { type: 'warning', icon: 'âš ï¸', key: 'bathroom-items', text: 'Beware of items from shelves' }
                    ]
                },
                office: {
                    icon: 'ğŸ’¼',
                    titleKey: 'in-office',
                    instructions: [
                        { type: 'do', icon: 'âœ…', key: 'office-desk', text: 'Hide under your desk' },
                        { type: 'do', icon: 'âœ…', key: 'office-drop-cover', text: 'Drop, cover, hold on' },
                        { type: 'do', icon: 'âœ…', key: 'office-protect-head', text: 'Protect head and neck' },
                        { type: 'dont', icon: 'âŒ', key: 'office-dont-look-up', text: "DON'T look up" },
                        { type: 'warning', icon: 'âš ï¸', key: 'office-lights', text: 'Risk of falling lights and ceiling tiles' }
                    ]
                },
                theater: {
                    icon: 'ğŸ¬',
                    titleKey: 'in-theater',
                    instructions: [
                        { type: 'do', icon: 'âœ…', key: 'theater-aisle', text: 'Crouch in aisle between seat rows' },
                        { type: 'do', icon: 'âœ…', key: 'theater-bend', text: 'If no space: bend over, hug head' },
                        { type: 'do', icon: 'âœ…', key: 'theater-below-seat', text: 'Stay below seat back level' },
                        { type: 'warning', icon: 'âš ï¸', key: 'theater-wall', text: 'Find sturdy wall if in aisle' }
                    ]
                },
                elevator: {
                    icon: 'ğŸ¢',
                    titleKey: 'in-elevator',
                    instructions: [
                        { type: 'do', icon: 'âœ…', key: 'elevator-outside', text: 'Crouch next to exterior elevator wall' },
                        { type: 'do', icon: 'âœ…', key: 'elevator-drop-cover', text: 'Drop, cover, hold on' },
                        { type: 'do', icon: 'âœ…', key: 'elevator-items', text: 'Use personal items to protect head' },
                        { type: 'dont', icon: 'âŒ', key: 'elevator-never-enter', text: 'NEVER enter elevator during earthquake' }
                    ]
                },
                street: {
                    icon: 'ğŸš¶',
                    titleKey: 'on-street',
                    instructions: [
                        { type: 'do', icon: 'âœ…', key: 'street-protect-head', text: 'Use bag/items to protect head' },
                        { type: 'do', icon: 'âœ…', key: 'street-avoid-buildings', text: 'Move away from buildings and trees' },
                        { type: 'do', icon: 'âœ…', key: 'street-stay-calm', text: 'Stay calm, wait for shaking to stop' },
                        { type: 'dont', icon: 'âŒ', key: 'bed-dont-get-up', text: "DON'T try to run indoors" },
                        { type: 'warning', icon: 'âš ï¸', key: 'kitchen-glass', text: 'Watch for falling signs and debris' }
                    ]
                },
                car: {
                    icon: 'ğŸš—',
                    titleKey: 'in-car',
                    instructions: [
                        { type: 'do', icon: 'âœ…', key: 'car-reduce-speed', text: 'Safely reduce speed and pull over' },
                        { type: 'do', icon: 'âœ…', key: 'car-hazard-lights', text: 'Turn on hazard lights' },
                        { type: 'do', icon: 'âœ…', key: 'car-avoid-bridges', text: 'Avoid bridges and overpasses' },
                        { type: 'warning', icon: 'âš ï¸', key: 'bed-wait', text: 'Wait until shaking stops before continuing' }
                    ]
                },
                station: {
                    icon: 'ğŸš‰',
                    titleKey: 'at-station',
                    instructions: [
                        { type: 'do', icon: 'âœ…', key: 'station-grab-rails', text: 'Hold onto handrails firmly' },
                        { type: 'do', icon: 'âœ…', key: 'station-lower-center', text: 'Lower your center of gravity' },
                        { type: 'do', icon: 'âœ…', key: 'office-drop-cover', text: 'Drop, cover, hold if space allows' },
                        { type: 'warning', icon: 'âš ï¸', key: 'theater-bend', text: 'If crowded: crouch and protect head' }
                    ]
                }
            };
            
            return situationData[situationId] || situationData.bed;
        }

        // Quiz functions - replaced with About
        function showAbout() {
            navigationStack.push('home');
            showScreen('about');
        }

        // Audio functions
        function playAudio() {
            if ('speechSynthesis' in window) {
                const text = getCurrentInstructions();
                const utterance = new SpeechSynthesisUtterance(text);
                
                // Set language
                if (currentLanguage === 'zh') {
                    utterance.lang = 'zh-TW';
                } else if (currentLanguage === 'ja') {
                    utterance.lang = 'ja-JP';
                } else {
                    utterance.lang = 'en-US';
                }
                
                utterance.rate = 0.8;
                utterance.pitch = 1;
                
                speechSynthesis.speak(utterance);
            } else {
                alert(getTranslation('audio-not-supported') || 'Audio not supported on this device.');
            }
        }

        function getCurrentInstructions() {
            const currentScreen = document.querySelector('.screen.active');
            let text = '';
            
            if (currentScreen.id === 'location-screen') {
                text = getTranslation('drop-cover-hold') || 'Drop, Cover, Hold On. ';
                text += getTranslation('step-drop') || '1. Drop to ground immediately. ';
                text += getTranslation('step-cover') || '2. Take cover under sturdy furniture. ';
                text += getTranslation('step-hold') || '3. Hold on and protect your head.';
            } else if (currentScreen.id === 'situation-screen') {
                const instructions = currentScreen.querySelectorAll('.instructions li span[data-text]');
                instructions.forEach(instruction => {
                    text += instruction.textContent + '. ';
                });
            }
            
            return text;
        }

        // Utility functions
        function getTranslation(key) {
            return translations[currentLanguage] && translations[currentLanguage][key];
        }

        // Extended translations - remove quiz-related translations
        Object.assign(translations.en, {
            'bed-stay': 'STAY in bed',
            'bed-pillow': 'Use pillow to protect head',
            'bed-prone': 'Turn face down (prone position)',
            'bed-dont-get-up': "DON'T get up and run",
            'bed-wait': 'Wait until shaking completely stops',
            'kitchen-fire-close': 'Turn off fire if next to stove',
            'kitchen-cover': 'Take cover under table',
            'kitchen-dont-reach': "DON'T risk injury to reach stove",
            'kitchen-hot': 'Watch for hot pots and spilling liquids',
            'kitchen-glass': 'Beware of falling dishes and glassware',
            'bathroom-dont-rush': "DON'T rush out of bathroom",
            'bathroom-crouch': 'Crouch low and protect head',
            'bathroom-basin': 'Use basin or hands to shield head',
            'bathroom-mirror': 'Watch for falling mirrors',
            'bathroom-items': 'Beware of items from shelves',
            'office-desk': 'Hide under your desk',
            'office-drop-cover': 'Drop, cover, hold on',
            'office-protect-head': 'Protect head and neck',
            'office-dont-look-up': "DON'T look up",
            'office-lights': 'Risk of falling lights and ceiling tiles',
            'theater-aisle': 'Crouch in aisle between seat rows',
            'theater-bend': 'If no space: bend over, hug head',
            'theater-below-seat': 'Stay below seat back level',
            'theater-wall': 'Find sturdy wall if in aisle',
            'elevator-outside': 'Crouch next to exterior elevator wall',
            'elevator-drop-cover': 'Drop, cover, hold on',
            'elevator-items': 'Use personal items to protect head',
            'elevator-never-enter': 'NEVER enter elevator during earthquake',
            'street-protect-head': 'Use bag/items to protect head',
            'street-avoid-buildings': 'Move away from buildings and trees',
            'street-stay-calm': 'Stay calm, wait for shaking to stop',
            'car-reduce-speed': 'Safely reduce speed and pull over',
            'car-hazard-lights': 'Turn on hazard lights',
            'car-avoid-bridges': 'Avoid bridges and overpasses',
            'station-grab-rails': 'Hold onto handrails firmly',
            'station-lower-center': 'Lower your center of gravity',
            'audio-not-supported': 'Audio not supported on this device.'
        });

        Object.assign(translations.zh, {
            'bed-stay': 'ç•™åœ¨åºŠä¸Š',
            'bed-pillow': 'ç”¨æ•é ­ä¿è­·é ­éƒ¨',
            'bed-prone': 'è¶´ä¸‹é¢æœä¸‹',
            'bed-dont-get-up': 'ä¸è¦èµ·èº«è·‘å‹•',
            'bed-wait': 'ç­‰åˆ°éœ‡å‹•å®Œå…¨åœæ­¢',
            'kitchen-fire-close': 'å¦‚åœ¨çˆç«æ—ç«‹å³é—œç«',
            'kitchen-cover': 'èº²åœ¨æ¡Œå­ä¸‹æ–¹',
            'kitchen-dont-reach': 'ä¸è¦å†’éšªå»é—œç«',
            'kitchen-hot': 'æ³¨æ„ç†±é‹å’Œæ½‘ç‘æ¶²é«”',
            'kitchen-glass': 'å°å¿ƒæ‰è½çš„é¤å…·å’Œç»ç’ƒ',
            'bathroom-dont-rush': 'ä¸è¦æ€¥è‘—è¡å‡ºæµ´å®¤',
            'bathroom-crouch': 'è¹²ä½ä¿è­·é ­éƒ¨',
            'bathroom-basin': 'ç”¨è‡‰ç›†æˆ–æ‰‹ä¿è­·é ­éƒ¨',
            'bathroom-mirror': 'æ³¨æ„æ‰è½çš„é¡å­',
            'bathroom-items': 'å°å¿ƒæ¶ä¸Šç‰©å“æ‰è½',
            'office-desk': 'èº²åœ¨è¾¦å…¬æ¡Œä¸‹',
            'office-drop-cover': 'è¶´ä¸‹ã€æ©è­·ã€ç©©ä½',
            'office-protect-head': 'ä¿è­·é ­é ¸éƒ¨',
            'office-dont-look-up': 'ä¸è¦å¾€ä¸Šçœ‹',
            'office-lights': 'å°å¿ƒæ‰è½çš„ç‡ˆå…·å’Œå¤©èŠ±æ¿',
            'theater-aisle': 'è¹²åœ¨åº§æ¤…é–“èµ°é“',
            'theater-bend': 'æ²’ç©ºé–“æ™‚ï¼šå½è…°æŠ±é ­',
            'theater-below-seat': 'ä¿æŒä½æ–¼æ¤…èƒŒé«˜åº¦',
            'theater-wall': 'åœ¨èµ°é“æ‰¾å …å›ºç‰†å£',
            'elevator-outside': 'è¹²åœ¨é›»æ¢¯å¤–ç‰†æ—',
            'elevator-drop-cover': 'è¶´ä¸‹ã€æ©è­·ã€ç©©ä½',
            'elevator-items': 'ç”¨éš¨èº«ç‰©å“ä¿è­·é ­éƒ¨',
            'elevator-never-enter': 'çµ•ä¸è¦é€²å…¥é›»æ¢¯',
            'street-protect-head': 'ç”¨åŒ…åŒ…ç­‰ç‰©å“ä¿è­·é ­éƒ¨',
            'street-avoid-buildings': 'é é›¢å»ºç¯‰ç‰©å’Œæ¨¹æœ¨',
            'street-stay-calm': 'ä¿æŒå†·éœï¼Œç­‰å¾…éœ‡å‹•åœæ­¢',
            'car-reduce-speed': 'å®‰å…¨æ¸›é€Ÿä¸¦é é‚Šåœè»Š',
            'car-hazard-lights': 'é–‹å•Ÿå±éšªè­¦ç¤ºç‡ˆ',
            'car-avoid-bridges': 'é¿é–‹æ©‹æ¨‘å’Œé«˜æ¶æ©‹',
            'station-grab-rails': 'ç‰¢ç‰¢æŠ“ä½æ‰¶æ‰‹',
            'station-lower-center': 'é™ä½é‡å¿ƒ',
            'audio-not-supported': 'æ­¤è¨­å‚™ä¸æ”¯æ´èªéŸ³åŠŸèƒ½ã€‚'
        });

        Object.assign(translations.ja, {
            'bed-stay': 'ãƒ™ãƒƒãƒ‰ã«ç•™ã¾ã‚‹',
            'bed-pillow': 'æ•ã§é ­ã‚’ä¿è­·ã™ã‚‹',
            'bed-prone': 'ã†ã¤ä¼ã›ã«ãªã‚‹',
            'bed-dont-get-up': 'èµ·ãä¸ŠãŒã£ã¦èµ°ã‚‰ãªã„',
            'bed-wait': 'æºã‚ŒãŒå®Œå…¨ã«æ­¢ã¾ã‚‹ã¾ã§å¾…ã¤',
            'kitchen-fire-close': 'ã‚³ãƒ³ãƒ­ã®è¿‘ããªã‚‰ç«ã‚’æ­¢ã‚ã‚‹',
            'kitchen-cover': 'ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¸‹ã«éš ã‚Œã‚‹',
            'kitchen-dont-reach': 'å±é™ºã‚’å†’ã—ã¦ã‚³ãƒ³ãƒ­ã«è¿‘ã¥ã‹ãªã„',
            'kitchen-hot': 'ç†±ã„é‹ã‚„æ¶²ä½“ã®é£›æ•£ã«æ³¨æ„',
            'kitchen-glass': 'è½ä¸‹ã™ã‚‹é£Ÿå™¨ã‚„ã‚¬ãƒ©ã‚¹ã«æ³¨æ„',
            'bathroom-dont-rush': 'æµ´å®¤ã‹ã‚‰æ…Œã¦ã¦å‡ºãªã„',
            'bathroom-crouch': 'ã—ã‚ƒãŒã‚“ã§é ­ã‚’ä¿è­·',
            'bathroom-basin': 'æ´—é¢å™¨ã‚„æ‰‹ã§é ­ã‚’å®ˆã‚‹',
            'bathroom-mirror': 'è½ä¸‹ã™ã‚‹é¡ã«æ³¨æ„',
            'bathroom-items': 'æ£šã‹ã‚‰ã®è½ä¸‹ç‰©ã«æ³¨æ„',
            'office-desk': 'æœºã®ä¸‹ã«éš ã‚Œã‚‹',
            'office-drop-cover': 'èº«ã‚’ä¼ã›ã€éš ã‚Œã€ã—ãŒã¿ã¤ã',
            'office-protect-head': 'é ­ã¨é¦–ã‚’ä¿è­·',
            'office-dont-look-up': 'ä¸Šã‚’è¦‹ãªã„',
            'office-lights': 'è½ä¸‹ã™ã‚‹ç…§æ˜ã‚„å¤©äº•æã«æ³¨æ„',
            'theater-aisle': 'åº§å¸­é–“ã®é€šè·¯ã«ã—ã‚ƒãŒã‚€',
            'theater-bend': 'ã‚¹ãƒšãƒ¼ã‚¹ãŒãªã„æ™‚ï¼šã‹ãŒã‚“ã§é ­ã‚’æŠ±ãˆã‚‹',
            'theater-below-seat': 'åº§å¸­ã®èƒŒã‚‚ãŸã‚Œã‚ˆã‚Šä½ã',
            'theater-wall': 'é€šè·¯ã§ã¯é ‘ä¸ˆãªå£ã‚’è¦‹ã¤ã‘ã‚‹',
            'elevator-outside': 'ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼å¤–å£ã®éš£ã«ã—ã‚ƒãŒã‚€',
            'elevator-drop-cover': 'èº«ã‚’ä¼ã›ã€éš ã‚Œã€ã—ãŒã¿ã¤ã',
            'elevator-items': 'èº«ã®å›ã‚Šå“ã§é ­ã‚’ä¿è­·',
            'elevator-never-enter': 'çµ¶å¯¾ã«ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ã«å…¥ã‚‰ãªã„',
            'street-protect-head': 'ã‹ã°ã‚“ãªã©ã§é ­ã‚’ä¿è­·',
            'street-avoid-buildings': 'å»ºç‰©ã‚„æœ¨ã‹ã‚‰é›¢ã‚Œã‚‹',
            'street-stay-calm': 'å†·é™ã«ã€æºã‚ŒãŒæ­¢ã¾ã‚‹ã®ã‚’å¾…ã¤',
            'car-reduce-speed': 'å®‰å…¨ã«æ¸›é€Ÿã—ã¦è·¯è‚©ã«åœè»Š',
            'car-hazard-lights': 'ãƒã‚¶ãƒ¼ãƒ‰ãƒ©ãƒ³ãƒ—ã‚’ç‚¹ç¯',
            'car-avoid-bridges': 'æ©‹ã‚„é«˜æ¶æ©‹ã‚’é¿ã‘ã‚‹',
            'station-grab-rails': 'æ‰‹ã™ã‚Šã‚’ã—ã£ã‹ã‚Šæ¡ã‚‹',
            'station-lower-center': 'é‡å¿ƒã‚’ä½ãã™ã‚‹',
            'audio-not-supported': 'ã“ã®ãƒ‡ãƒã‚¤ã‚¹ã§ã¯éŸ³å£°ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚'
        });

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, starting initialization...');
            init();
            
            // Add event listeners to avoid inline onclick issues
            document.querySelector('.emergency-button').addEventListener('click', showEmergencyMode);
            
            // Home screen location cards
            const locationCards = document.querySelectorAll('#home-screen .location-card');
            locationCards[0].addEventListener('click', () => showLocationGuide('indoor'));
            locationCards[1].addEventListener('click', () => showLocationGuide('outdoor'));
            locationCards[2].addEventListener('click', showAbout);
            
            // Emergency screen location cards
            const emergencyCards = document.querySelectorAll('#emergency-screen .location-card');
            emergencyCards[0].addEventListener('click', () => showEmergencyGuide('indoor'));
            emergencyCards[1].addEventListener('click', () => showEmergencyGuide('outdoor'));
            emergencyCards[2].addEventListener('click', () => showEmergencyGuide('vehicle'));
            
            // Navigation items
            const navItems = document.querySelectorAll('.nav-item');
            navItems[0].addEventListener('click', () => showScreen('home'));
            navItems[1].addEventListener('click', showEmergencyMode);
            navItems[2].addEventListener('click', showAbout);
            
            // Back button
            document.querySelector('.back-button').addEventListener('click', goBack);
            
            // Language selector
            document.querySelector('.language-selector').addEventListener('change', function(e) {
                changeLanguage(e.target.value);
            });
            
            // Audio buttons
            document.querySelectorAll('.audio-button').forEach(btn => {
                btn.addEventListener('click', playAudio);
            });
        });

        // Add service worker for offline functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }

        // Add touch gestures for better mobile experience
        let touchStartX = 0;
        let touchStartY = 0;

        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
        }, false);

        document.addEventListener('touchend', e => {
            const touchEndX = e.changedTouches[0].screenX;
            const touchEndY = e.changedTouches[0].screenY;
            const diffX = touchStartX - touchEndX;
            const diffY = touchStartY - touchEndY;
            
            // Swipe right to go back
            if (Math.abs(diffX) > Math.abs(diffY) && diffX < -100) {
                if (navigationStack.length > 0) {
                    goBack();
                }
            }
        }, false);

    </script>
</body>
</html>